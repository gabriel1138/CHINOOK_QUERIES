RECEITA CONSOLIDADA POR ANO, E DIFERENÃ‡A EM % DO ANO ANTERIOR
TOTAL AMMOUNT PER YEAR AND DIFFERENCE 

WITH TOTAL_ANO
AS (
	SELECT EXTRACT(YEAR FROM INVOICE_DATE) AS ANO
		,SUM(TOTAL) AS TOTAL
	FROM INVOICE
	GROUP BY ANO
	ORDER BY ANO ASC
	) -- CTA PARA CRIAR LISTA DOS ANOS E VALOR TOTAL
SELECT ANO
	,TOTAL
	,coalesce(TOTAL - LAG(TOTAL) OVER (), 0) AS dif_ano_anterior
	,coalesce(round((total - lag(total) OVER ()) / lag(total) OVER () * 100, 2), 0) || ' ' || '%' AS var_perc
FROM TOTAL_ANO
