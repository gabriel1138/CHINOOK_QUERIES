TOTAL GERAL DAS COMPRAS E TOTAL POR PAIS
TOTAL SALES AMMOUNT AND TOTAL BY COUNTRY

WITH total_pais
AS (
	SELECT COUNTRY
		,SUM(TOTAL) AS TOTAL_PAIS
		,(
			SELECT SUM(TOTAL)
			FROM INVOICE
			) AS TOTAL_GERAL
	FROM CUSTOMER C
	LEFT JOIN INVOICE IV ON C.CUSTOMER_ID = IV.CUSTOMER_ID
	GROUP BY COUNTRY
	ORDER BY TOTAL_PAIS DESC
	) -- CRIAMOS UMA LISTA DE PAISES E O VALOR TOTAL ,TRANSFORMAMOS EM CTE
SELECT country
	,total_pais
	,total_geral
	,round((total_pais / total_geral) * 100, 2) AS representacao_mercado -- quanto cada pais representa na receita
FROM total_pais
